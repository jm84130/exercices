<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Organigramme ‚Äì Transport routier LEGRAKK TPS ‚Äì interactif</title>
<style>
  html,body{height:100%;margin:0;background:#0f172a;color:#e5e7eb;font-family:Arial,sans-serif;}
  body{background:linear-gradient(180deg,#0f172a,#030712 30%);}
  header{position:sticky;top:0;z-index:5;background:rgba(17,24,39,0.95);border-bottom:1px solid rgba(148,163,184,0.15)}
  .wrap{max-width:1200px;margin:0 auto;padding:12px 16px}
  h1{margin:0;font-size:18px} .sub{color:#9ca3af;font-size:12px}
  .toolbar{margin-top:8px}
  .btn{background:#2563eb;color:#fff;border:0;padding:6px 10px;border-radius:10px;cursor:pointer;font-size:13px;margin:2px;display:inline-block;box-shadow:0 8px 16px rgba(0,0,0,.30),0 4px 4px rgba(0,0,0,.22)}
  .btn.secondary{background:#334155}
  .btn.ghost{background:transparent;border:1px solid rgba(148,163,184,.25);color:#e5e7eb}
  .tree{padding:16px 32px 16px 320px;overflow:auto;height:calc(100% - 146px)}
  .node{display:inline-block;position:relative;border:1px solid rgba(148,163,184,.18);border-radius:12px;
        padding:8px 10px;min-width:160px;box-shadow:0 8px 16px rgba(0,0,0,.30),0 4px 4px rgba(0,0,0,.22);cursor:pointer;user-select:none;text-align:center}
  .node.pdg{background:rgba(255,255,255,0.125);border-color:#e5e7eb}
  .node.comm{background:rgba(30,64,175,0.125);border-color:#60a5fa}
  .node.expl{background:rgba(6,78,59,0.125);border-color:#34d399}
  .node.fact{background:rgba(120,53,15,0.125);border-color:#f59e0b}
  .node.rh{background:rgba(131,24,67,0.125);border-color:#f472b6}
  .node.tech{background:rgba(250,204,21,0.125);border-color:#facc15}
  .node.qse{background:rgba(8,145,178,0.125);border-color:#67e8f9}
  .title{font-weight:700;font-size:13px;line-height:1.2}
  .level{font-size:10px;color:#9ca3af;margin-top:2px}
  .meta{font-size:11px;color:#9ca3af;margin-top:2px}
  .poste{color:#93c5fd}
  .tree ul{padding-top:14px;position:relative;display:flex;gap:18px;justify-content:flex-start;flex-wrap:nowrap}
  .tree ul::before{content:"";position:absolute;top:0;left:0;right:0;margin:auto;border-top:1px dashed rgba(148,163,184,.25);width:95%}
  .tree li{list-style:none;text-align:center;position:relative;padding:16px 4px 0 4px}
  .tree li::before,.tree li::after{content:"";position:absolute;top:0;width:50%;height:16px;border-top:1px dashed rgba(148,163,184,.25)}
  .tree li::before{left:-50%;border-right:1px dashed rgba(148,163,184,.25)}
  .tree li::after{right:-50%;border-left:1px dashed rgba(148,163,184,.25)}
  .tree li:only-child::before,.tree li:only-child::after{display:none}
  .tree li:first-child::before,.tree li:last-child::after{border:0 none}
  .collapsed>ul{display:none}

  /* Vue par niveaux */
  .levels{display:none;padding:16px 32px 16px 48px;overflow:auto;height:calc(100% - 146px)}
  .levels .row-title{font-size:12px;color:#9ca3af;margin:10px 0 6px 2px}
  .levels .row{display:flex;gap:14px;align-items:flex-start;flex-wrap:nowrap;overflow-x:auto;padding-bottom:6px}
  .levels .node{min-width:160px}

  /* Toast succ√®s centr√© */
  .toasts{position:fixed;left:50%;top:50%;z-index:100;pointer-events:none}
  .toast{background:rgba(17,24,39,0.9);border:2px solid rgba(148,163,184,.6);color:#e5e7eb;
         padding:16px 22px;border-radius:14px;font-size:16px;box-shadow:0 8px 16px rgba(0,0,0,.30),0 4px 4px rgba(0,0,0,.22);
         min-width:260px;text-align:center;position:relative;left:-50%;top:-50%}
  .toast .title{font-weight:800;font-size:17px;margin-bottom:4px}
  .toast .txt{font-size:14px;color:#cbd5e1}
  footer{text-align:center;color:#9ca3af;font-size:12px;padding:10px 0 14px;border-top:1px solid rgba(148,163,184,.15);background:rgba(15,23,42,.4)}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>Organigramme ‚Äì Transport routier LEGRAKK TPS <span class="sub">(clic = d√©plier/replier ¬∑ Alt+clic = toute la branche)</span></h1>
    <div class="toolbar">
      <button class="btn" id="expandAll">Tout d√©velopper</button>
      <button class="btn secondary" id="collapseAll">Tout replier</button>
      <button class="btn ghost" id="toggleView">Vue par niveaux</button>
    </div>
  </div>
</header>

<div class="tree" id="tree"></div>
<div class="levels" id="levels"></div>
<div class="toasts" id="toasts"></div>

<script>
(function(){
  const regions=["Paris","Nord-Ouest","Nord-Est","Sud-Ouest","Sud-Est"];
  const Q={COMM:5,MEC:20,PL:80,SPL:50,QUAI:30};
  const easterNames=new Set([
    "Akira Toriyama","Jean-Marie Chazel","Fabrice Blondot","Muhammad Ali","Mikasa Akerman",
    "Sheldon Cooper","Rajesh Koothrappali","Howard Wolowitz","Monica Geller","Walter White",
    "Daenerys Targaryen","Enid Sinclair","Ichigo Kurosaki","Light Yagami","Eikichi Onizuka",
    "Morgan Freeman","Oprah Winfrey","Ellen Ripley","???"
  ]);

  const P={PDG:{nom:"Jean-Marie Chazel",poste:"999"},
    Resp_Com_Nat:{nom:"Muhammad Ali",poste:"191"},Resp_Expl_Nat:{nom:"Mikasa Akerman",poste:"192"},
    Resp_Fact:{nom:"Walter White",poste:"193"},Cpt_Four:{nom:"Monica Geller",poste:"194"},
    Cpt_Cli:{nom:"Oprah Winfrey",poste:"195"},Resp_RH:{nom:"Fabrice Blondot",poste:"196"},
    Gest_Parc:{nom:"Howard Wolowitz",poste:"197"},Resp_QSE:{nom:"Ellen Ripley",poste:"198"},
    Form_Nat:{nom:"Eikichi Onizuka",poste:"199"},
    Resp_Com_Paris:{nom:"Ichigo Kurosaki",poste:"291"},Resp_Com_NO:{nom:"Light Yagami",poste:"292"},
    Resp_Com_NE:{nom:"Enid Sinclair",poste:"293"},Resp_Com_SO:{nom:"Morgan Freeman",poste:"294"},
    Resp_Com_SE:{nom:"Akira Toriyama",poste:"295"},
    Resp_Expl_Paris:{nom:"Rajesh Koothrappali",poste:"296"},Resp_Expl_NO:{nom:"Sheldon Cooper",poste:"297"},
    Resp_Expl_NE:{nom:"Daenerys Targaryen",poste:"298"},Resp_Expl_SO:{nom:"Amadou Diop",poste:"299"},
    Resp_Expl_SE:{nom:"???",poste:"219"},
    Explo_Paris:{nom:"Hassan Khan",poste:"231"},Explo_NO:{nom:"Selma Haddou",poste:"232"},
    Explo_NE:{nom:"Ethan Johnson",poste:"233"},Explo_SO:{nom:"Maya Lopez",poste:"234"},
    Explo_SE:{nom:"Ji-ho Park",poste:"235"},
    ChefQuai_Paris:{nom:"A√Øcha Diallo",poste:"261"},ChefQuai_NO:{nom:"Isabella Rossi",poste:"262"},
    ChefQuai_NE:{nom:"Kwame Mensah",poste:"263"},ChefQuai_SO:{nom:"Youssef Benali",poste:"264"},
    ChefQuai_SE:{nom:"Bao Nguyen",poste:"265"},
    Chef_Parc_Paris:{nom:"Selim Kaya",poste:"241"},Chef_Parc_NO:{nom:"Kofi Boateng",poste:"242"},
    Chef_Parc_NE:{nom:"Jade Nguyen",poste:"243"},Chef_Parc_SO:{nom:"Tariq Rahman",poste:"244"},
    Chef_Parc_SE:{nom:"Camila Costa",poste:"245"},
    Form_Paris:{nom:"Chlo√© Dubois",poste:"251"},Form_NO:{nom:"Yuna Tanaka",poste:"252"},
    Form_NE:{nom:"Rafael Silva",poste:"253"},Form_SO:{nom:"Olaide Adebayo",poste:"254"},
    Form_SE:{nom:"Nora Svensson",poste:"255"}};

  function makeNode({title,level,pole,nom,poste,children=[]}){return{title,level,pole,name:nom||"",poste:poste||"",children};}
  function isPole(t){return t.toLowerCase().includes("p√¥le")||t.toLowerCase().includes("direction");}

  const toasts=document.getElementById("toasts"),achieved=new Set(),clicked=new Set();
  function toast(t,txt){const b=document.createElement("div");b.className="toast";b.innerHTML='<div class="title">üèÜ '+t+'</div><div class="txt">'+txt+'</div>';toasts.innerHTML="";toasts.appendChild(b);setTimeout(function(){if(b.parentNode)b.parentNode.removeChild(b);},2600);}
  function unlock(id,t,txt){if(achieved.has(id))return;achieved.add(id);toast(t,txt);}

  const root=makeNode({title:"PDG",level:1,pole:"pdg",nom:P.PDG.nom,poste:P.PDG.poste,children:[
    makeNode({title:"P√¥le Commercial",pole:"comm"}),
    makeNode({title:"P√¥le Exploitation",pole:"expl"}),
    makeNode({title:"Direction Facturation & Administratif",pole:"fact"}),
    makeNode({title:"P√¥le RH",pole:"rh"}),
    makeNode({title:"P√¥le Technique & Parc",pole:"tech"}),
    makeNode({title:"P√¥le Qualit√© & S√©curit√© Environnement",pole:"qse"})
  ]});
  const [pComm,pExpl,pFact,pRh,pTech,pQSE]=root.children;
  const respComNat=makeNode({title:"Responsable commercial national",level:2,pole:"comm",nom:P.Resp_Com_Nat.nom,poste:P.Resp_Com_Nat.poste});
  const respExNat=makeNode({title:"Responsable exploitation national",level:2,pole:"expl",nom:P.Resp_Expl_Nat.nom,poste:P.Resp_Expl_Nat.poste});
  const respFact=makeNode({title:"Responsable facturation",level:2,pole:"fact",nom:P.Resp_Fact.nom,poste:P.Resp_Fact.poste});
  const cptFour=makeNode({title:"Comptabilit√© fournisseur",level:2,pole:"fact",nom:P.Cpt_Four.nom,poste:P.Cpt_Four.poste});
  const cptCli=makeNode({title:"Comptabilit√© client",level:2,pole:"fact",nom:P.Cpt_Cli.nom,poste:P.Cpt_Cli.poste});
  const respRH=makeNode({title:"Responsable RH",level:2,pole:"rh",nom:P.Resp_RH.nom,poste:P.Resp_RH.poste});
  const gestParc=makeNode({title:"Gestionnaire Parc et Services",level:2,pole:"tech",nom:P.Gest_Parc.nom,poste:P.Gest_Parc.poste});
  const respQSE=makeNode({title:"Responsable QSE",level:2,pole:"qse",nom:P.Resp_QSE.nom,poste:P.Resp_QSE.poste});
  const formNat=makeNode({title:"Formateur national",level:3,pole:"qse",nom:P.Form_Nat.nom,poste:P.Form_Nat.poste});
  pComm.children.push(respComNat);pExpl.children.push(respExNat);pFact.children.push(respFact,cptFour,cptCli);
  pRh.children.push(respRH);pTech.children.push(gestParc);pQSE.children.push(respQSE);respQSE.children.push(formNat);

  const comReg=[P.Resp_Com_Paris,P.Resp_Com_NO,P.Resp_Com_NE,P.Resp_Com_SO,P.Resp_Com_SE];
  const explReg=[P.Resp_Expl_Paris,P.Resp_Expl_NO,P.Resp_Expl_NE,P.Resp_Expl_SO,P.Resp_Expl_SE];
  const exploNom=[P.Explo_Paris,P.Explo_NO,P.Explo_NE,P.Explo_SO,P.Explo_SE];
  const chefQuai=[P.ChefQuai_Paris,P.ChefQuai_NO,P.ChefQuai_NE,P.ChefQuai_SO,P.ChefQuai_SE];
  const parcReg=[P.Chef_Parc_Paris,P.Chef_Parc_NO,P.Chef_Parc_NE,P.Chef_Parc_SO,P.Chef_Parc_SE];
  const formReg=[P.Form_Paris,P.Form_NO,P.Form_NE,P.Form_SO,P.Form_SE];

  for(var i=0;i<regions.length;i++){
    var r=regions[i];
    respExNat.children.push(makeNode({title:"Responsable exploitation r√©gional ‚Äì "+r,level:3,pole:"expl",nom:explReg[i].nom,poste:explReg[i].poste,children:[
      makeNode({title:"Exploitant¬∑e",level:4,pole:"expl",nom:exploNom[i].nom,poste:exploNom[i].poste,children:[
        makeNode({title:"Chef de quai",level:5,pole:"expl",nom:chefQuai[i].nom,poste:chefQuai[i].poste,children:[
          makeNode({title:"Techniciens de quai ("+Q.QUAI+")",level:6,pole:"expl"})
        ]}),
        makeNode({title:"Conducteurs PL ("+Q.PL+")",level:5,pole:"expl"}),
        makeNode({title:"Conducteurs SPL ("+Q.SPL+")",level:5,pole:"expl"})
      ]})
    ]}));
    respComNat.children.push(makeNode({title:"Responsable commercial r√©gional ‚Äì "+r,level:4,pole:"comm",nom:comReg[i].nom,poste:comReg[i].poste,children:[
      makeNode({title:"Commerciaux ("+Q.COMM+")",level:5,pole:"comm"})
    ]}));
    gestParc.children.push(makeNode({title:"Chef de Parc ‚Äì "+r,level:4,pole:"tech",nom:parcReg[i].nom,poste:parcReg[i].poste,children:[
      makeNode({title:"M√©caniciens PL ("+Q.MEC+")",level:5,pole:"tech"})
    ]}));
    formNat.children.push(makeNode({title:"Formateur r√©gional ‚Äì "+r,level:4,pole:"qse",nom:formReg[i].nom,poste:formReg[i].poste}));
  }

  const tree=document.getElementById("tree");
  const levels=document.getElementById("levels");
  const topUL=document.createElement("ul");
  topUL.appendChild(renderNode(root,true));
  tree.appendChild(topUL);
  collapseToPoles();

  document.getElementById("expandAll").onclick=function(){var lis=document.querySelectorAll(".tree li");for(var i=0;i<lis.length;i++){lis[i].classList.remove("collapsed");}unlock("bordel","Un bordel organis√©","Vous avez tout d√©ploy√©.");};
  document.getElementById("collapseAll").onclick=collapseToPoles;
  document.getElementById("toggleView").onclick=toggleView;

  function renderNode(n,isRoot){
    const li=document.createElement("li");
    const card=document.createElement("div");
    card.className="node "+(n.pole||"");
    var lvl=(!n.level||isPole(n.title))?"":'<div class="level">Niveau '+n.level+'</div>';
    var meta=(n.name||n.poste)?'<div class="meta"><span>'+(n.name||"")+'</span>'+(n.poste?' ¬∑ <span class="poste">poste '+n.poste+'</span>':"")+'</div>':"";
    card.innerHTML='<div class="title">'+n.title+'</div>'+lvl+meta;
    card.onclick=function(e){
      e=e||window.event;
      if(e.stopPropagation)e.stopPropagation();
      if(n.name){
        clicked.add(n.name);
        if(clicked.has("Jean-Marie Chazel")&&clicked.has("Fabrice Blondot"))unlock("ils","Les terreurs sont l√† !","Jean-Marie Chazel et Fabrice Blondot ont √©t√© cliqu√©s.");
        if(n.name==="???")unlock("myst","Qui est-ce ?","Vous avez trouv√© ???");
        var all=true;easterNames.forEach(function(x){if(!clicked.has(x))all=false;});if(all)unlock("pokedex","Attrapez-les tous","Tous les personnages easter-egg ont √©t√© cliqu√©s !");
      }
      toggle(li,e.altKey);
    };
    li.appendChild(card);
    if(n.children&&n.children.length){
      const ul=document.createElement("ul");
      for(var i=0;i<n.children.length;i++){ul.appendChild(renderNode(n.children[i]));}
      li.appendChild(ul);
      li.classList.add("collapsed");
      if(isRoot)li.classList.remove("collapsed");
    }
    return li;
  }

  function toggle(li,deep){
    const ul=li.querySelector("ul");if(!ul)return;
    var expand=li.classList.contains("collapsed");
    li.classList.toggle("collapsed");
    if(deep){
      var childLis=ul.querySelectorAll("li");
      for(var i=0;i<childLis.length;i++){
        if(expand){childLis[i].classList.remove("collapsed");}else{childLis[i].classList.add("collapsed");}
      }
    }
  }
  
  function collapseAll(){var lis=document.querySelectorAll(".tree li");for(var i=0;i<lis.length;i++){lis[i].classList.add("collapsed");}}
  
  function collapseToPoles(){
    collapseAll();
    var r=topUL.firstElementChild;
    if(!r)return;
    r.classList.remove("collapsed");
    tree.scrollLeft=0;
  }

  function collectByLevel(){
    var m={poles:[]};
    for(var i=0;i<root.children.length;i++){m.poles.push(root.children[i]);}
    (function w(n){if(n.level){if(!m[n.level])m[n.level]=[];m[n.level].push(n);}if(n.children){for(var i=0;i<n.children.length;i++){w(n.children[i]);}}})(root);
    return m;
  }
  
  function cardify(n,hide){
    var d=document.createElement("div");
    d.className="node "+(n.pole||"");
    var lvl=(!n.level||isPole(n.title)||hide)?"":'<div class="level">Niveau '+n.level+'</div>';
    var meta=(n.name||n.poste)?'<div class="meta"><span>'+(n.name||"")+'</span>'+(n.poste?' ¬∑ <span class="poste">poste '+n.poste+'</span>':"")+'</div>':"";
    d.innerHTML='<div class="title">'+n.title+'</div>'+lvl+meta;
    return d;
  }
  
  function buildLevelsView(){
    levels.innerHTML="";
    var g=collectByLevel();
    
    var n1=document.createElement("div");
    n1.innerHTML='<div class="row-title">Niveau 1</div><div class="row"></div>';
    levels.appendChild(n1);
    n1.querySelector(".row").appendChild(cardify(root));
    
    var pole=document.createElement("div");
    pole.innerHTML='<div class="row-title">P√¥les</div><div class="row"></div>';
    levels.appendChild(pole);
    for(var i=0;i<g.poles.length;i++){pole.querySelector(".row").appendChild(cardify(g.poles[i],true));}
    
    var max=0;
    for(var key in g){if(key!=="poles"&&Number(key)>max){max=Number(key);}}
    
    for(var L=2;L<=max;L++){
      if(!g[L])continue;
      var w=document.createElement("div");
      w.innerHTML='<div class="row-title">Niveau '+L+'</div><div class="row"></div>';
      levels.appendChild(w);
      for(var i=0;i<g[L].length;i++){w.querySelector(".row").appendChild(cardify(g[L][i]));}
    }
  }
  
  var byLevels=false;
  function toggleView(){
    byLevels=!byLevels;
    var b=document.getElementById("toggleView");
    if(byLevels){
      buildLevelsView();
      tree.style.display="none";
      levels.style.display="block";
      b.textContent="Vue arborescence";
    }else{
      levels.style.display="none";
      tree.style.display="block";
      b.textContent="Vue par niveaux";
    }
  }
})();
</script>

<footer>
  Logiciel cr√©√© et propos√© par <strong>M. Chazel</strong> ‚Äì Professeur, Lyc√©e professionnel <strong>Les Alpilles</strong> ‚Äì Miramas
</footer>
</body>
</html>